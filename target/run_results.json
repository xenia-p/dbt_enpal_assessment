{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.3", "generated_at": "2026-02-11T19:12:55.718592Z", "invocation_id": "17209ebd-689b-4581-8aa4-f924933f14d2", "invocation_started_at": "2026-02-11T19:12:52.010985Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.272935Z", "completed_at": "2026-02-11T19:12:53.280087Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.280490Z", "completed_at": "2026-02-11T19:12:53.382351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11075973510742188, "adapter_response": {"_message": "SELECT 4579", "code": "SELECT", "rows_affected": 4579}, "message": "SELECT 4579", "failures": null, "unique_id": "model.enpal_assessment_project.stg_activity", "compiled": true, "compiled_code": "SELECT\n  activity_id,\n  type,\n  assigned_to_user AS user_id,\n  deal_id,\n  done,\n  due_to\nFROM \"postgres\".\"public\".\"activity\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.387763Z", "completed_at": "2026-02-11T19:12:53.393280Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.393698Z", "completed_at": "2026-02-11T19:12:53.473521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08713603019714355, "adapter_response": {"_message": "SELECT 15406", "code": "SELECT", "rows_affected": 15406}, "message": "SELECT 15406", "failures": null, "unique_id": "model.enpal_assessment_project.stg_deal_changes", "compiled": true, "compiled_code": "\n\nSELECT\n  deal_id,\n  change_time,\n  changed_field_key,\n  new_value\nFROM \"postgres\".\"public\".\"deal_changes\"\nWHERE 1 = 1\n\n  ", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.478227Z", "completed_at": "2026-02-11T19:12:53.481640Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.482099Z", "completed_at": "2026-02-11T19:12:53.540615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06383109092712402, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_dim_activity_types", "compiled": true, "compiled_code": "\n\nSELECT\n  id,\n  name,\n  active,\n  type\nFROM \"postgres\".\"public\".\"activity_types\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_dim_activity_types\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.544612Z", "completed_at": "2026-02-11T19:12:53.548135Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.548539Z", "completed_at": "2026-02-11T19:12:53.594849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05160188674926758, "adapter_response": {"_message": "SELECT 773", "code": "SELECT", "rows_affected": 773}, "message": "SELECT 773", "failures": null, "unique_id": "model.enpal_assessment_project.stg_dim_dates", "compiled": true, "compiled_code": "\n\nWITH bounds AS (\n  SELECT\n    \n            date '2024-01-01' as run_start_date\n        ,\n    current_date AS end_date\n),\n\ndates AS (\n  SELECT gs::date AS start_date\n  FROM bounds\n  CROSS JOIN LATERAL generate_series(\n    bounds.run_start_date::date,\n    bounds.end_date::date,\n    interval '1 day'\n  ) AS gs\n)\n\nSELECT\n  start_date,\n  (start_date + interval '1 day')::date AS next_date,\n  date_trunc('month', start_date)::date AS start_month,\n  date_trunc('month', (start_date + interval '1 month'))::date AS next_month,\n  (start_date + interval '1 year')::date AS next_year\nFROM dates", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.599394Z", "completed_at": "2026-02-11T19:12:53.602937Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.603418Z", "completed_at": "2026-02-11T19:12:53.647188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04929685592651367, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.enpal_assessment_project.stg_dim_lost_reasons", "compiled": true, "compiled_code": "\n\nWITH t AS (\n  SELECT *\n  FROM \"postgres\".\"public\".\"fields\"\n  WHERE field_key = 'lost_reason'\n)\n\nSELECT\n  opt ->> 'id' AS option_id,\n  opt ->> 'label' AS option_label\nFROM t\nCROSS JOIN LATERAL jsonb_array_elements(t.field_value_options::jsonb) AS opt", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_dim_lost_reasons\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.651808Z", "completed_at": "2026-02-11T19:12:53.655202Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.655655Z", "completed_at": "2026-02-11T19:12:53.699919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0496220588684082, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enpal_assessment_project.stg_dim_stages", "compiled": true, "compiled_code": "\n\n-- Staging model for `activity_types` source\nSELECT\n  stage_id,\n  stage_name\nFROM \"postgres\".\"public\".\"stages\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_dim_stages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.704475Z", "completed_at": "2026-02-11T19:12:53.707671Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.708142Z", "completed_at": "2026-02-11T19:12:53.752842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04984402656555176, "adapter_response": {"_message": "SELECT 1787", "code": "SELECT", "rows_affected": 1787}, "message": "SELECT 1787", "failures": null, "unique_id": "model.enpal_assessment_project.stg_dim_users", "compiled": true, "compiled_code": "SELECT\n  id,\n  name,\n  email,\n  modified\nFROM \"postgres\".\"public\".\"users\"", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"stg_dim_users\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.757277Z", "completed_at": "2026-02-11T19:12:53.769628Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.770104Z", "completed_at": "2026-02-11T19:12:53.807385Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05240607261657715, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_activity_id.a68836e3e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.811836Z", "completed_at": "2026-02-11T19:12:53.816378Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.817022Z", "completed_at": "2026-02-11T19:12:53.840264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03085184097290039, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_done.b11b4fabd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect done\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\nwhere done is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.844902Z", "completed_at": "2026-02-11T19:12:53.907319Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.907876Z", "completed_at": "2026-02-11T19:12:53.932335Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09009218215942383, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_due_to.2c68492873", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect due_to\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\nwhere due_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.937776Z", "completed_at": "2026-02-11T19:12:53.943002Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.943520Z", "completed_at": "2026-02-11T19:12:53.965861Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03071117401123047, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_type.06aef42c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\nwhere type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:53.970552Z", "completed_at": "2026-02-11T19:12:53.975440Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:53.975993Z", "completed_at": "2026-02-11T19:12:53.997504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02958226203918457, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_activity_user_id.50d7599272", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.002460Z", "completed_at": "2026-02-11T19:12:54.007418Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.007914Z", "completed_at": "2026-02-11T19:12:54.030052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030108928680419922, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_change_time.d739b89f9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.034766Z", "completed_at": "2026-02-11T19:12:54.039543Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.040060Z", "completed_at": "2026-02-11T19:12:54.061630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029280662536621094, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_changed_field_key.bd8a8a5b1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect changed_field_key\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"\nwhere changed_field_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.066423Z", "completed_at": "2026-02-11T19:12:54.072965Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.073464Z", "completed_at": "2026-02-11T19:12:54.095378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03141498565673828, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_deal_changes_deal_id.32d7e9b75e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.100277Z", "completed_at": "2026-02-11T19:12:54.104888Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.105349Z", "completed_at": "2026-02-11T19:12:54.126259Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028354167938232422, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_activity_types_id.8a24bd2d18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_activity_types\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.130890Z", "completed_at": "2026-02-11T19:12:54.135528Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.135985Z", "completed_at": "2026-02-11T19:12:54.156482Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028317928314208984, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_activity_types_name.2e605102b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_activity_types\"\nwhere name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.161368Z", "completed_at": "2026-02-11T19:12:54.168482Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.168968Z", "completed_at": "2026-02-11T19:12:54.190069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03144502639770508, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_stg_dim_activity_types_id.1f50e53622", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_activity_types\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.194966Z", "completed_at": "2026-02-11T19:12:54.199712Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.200171Z", "completed_at": "2026-02-11T19:12:54.265054Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07260394096374512, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_dates_start_date.08bfaceec7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_dates\"\nwhere start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.269856Z", "completed_at": "2026-02-11T19:12:54.277002Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.277473Z", "completed_at": "2026-02-11T19:12:54.299117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03187131881713867, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_stg_dim_dates_start_date.c5ea5c8402", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    start_date as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_dates\"\nwhere start_date is not null\ngroup by start_date\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.304248Z", "completed_at": "2026-02-11T19:12:54.311020Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.311611Z", "completed_at": "2026-02-11T19:12:54.336911Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.035633087158203125, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_lost_reasons_option_id.5be3af74db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect option_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_lost_reasons\"\nwhere option_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.342769Z", "completed_at": "2026-02-11T19:12:54.348431Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.348972Z", "completed_at": "2026-02-11T19:12:54.372433Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03267788887023926, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_lost_reasons_option_label.7c1d7a385a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect option_label\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_lost_reasons\"\nwhere option_label is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.377646Z", "completed_at": "2026-02-11T19:12:54.382300Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.382788Z", "completed_at": "2026-02-11T19:12:54.403818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028622150421142578, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_stg_dim_lost_reasons_option_id.3ecb2e915d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    option_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_lost_reasons\"\nwhere option_id is not null\ngroup by option_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.408658Z", "completed_at": "2026-02-11T19:12:54.413233Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.413682Z", "completed_at": "2026-02-11T19:12:54.434584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028660058975219727, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_stages_stage_id.1ba714317d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.439296Z", "completed_at": "2026-02-11T19:12:54.444220Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.444695Z", "completed_at": "2026-02-11T19:12:54.468151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03144383430480957, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_stages_stage_name.2a79f1f049", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_stages\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.472965Z", "completed_at": "2026-02-11T19:12:54.477810Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.478275Z", "completed_at": "2026-02-11T19:12:54.499142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02869701385498047, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_stg_dim_stages_stage_id.f759b9af02", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.504204Z", "completed_at": "2026-02-11T19:12:54.509319Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.509788Z", "completed_at": "2026-02-11T19:12:54.530340Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028541088104248047, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_stg_dim_users_id.fbc1b74cbd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_users\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.535096Z", "completed_at": "2026-02-11T19:12:54.544451Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.544940Z", "completed_at": "2026-02-11T19:12:54.567048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03452610969543457, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.relationships_stg_activity_user_id__id__ref_stg_dim_users_.2b42490540", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\"\n    where user_id is not null\n),\n\nparent as (\n    select id as to_field\n    from \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_users\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.571705Z", "completed_at": "2026-02-11T19:12:54.576555Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.577047Z", "completed_at": "2026-02-11T19:12:54.598249Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02916121482849121, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_stg_dim_users_id.b67ffe191a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_users\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.603297Z", "completed_at": "2026-02-11T19:12:54.607148Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.607632Z", "completed_at": "2026-02-11T19:12:54.671969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07017087936401367, "adapter_response": {"_message": "SELECT 10908", "code": "SELECT", "rows_affected": 10908}, "message": "SELECT 10908", "failures": null, "unique_id": "model.enpal_assessment_project.interm_deals_stages_enriched", "compiled": true, "compiled_code": "WITH activities AS (\n  SELECT\n    activity.deal_id,\n    CASE\n      WHEN type = 'meeting' THEN 2.1\n      WHEN type = 'sc_2' THEN 3.1\n    END AS stage,\n    due_to AS change_time,\n    null AS lost_reason\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_activity\" AS activity\n  --theoretically this join is not needed when all deals in activities have a stage change, \n  --I add it to avoid including activities for deals that are not in our main dataset\n  INNER JOIN (SELECT DISTINCT deal_id FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\") AS deals\n    ON activity.deal_id = deals.deal_id\n  WHERE\n    done IS true\n    AND type IN ('meeting', 'sc_2')\n),\n\nunioned AS (\n  SELECT\n    deal_id,\n    CASE\n      WHEN changed_field_key = 'stage_id'\n        THEN new_value::numeric\n      WHEN changed_field_key = 'lost_reason'\n        THEN 0::numeric\n    END AS stage,\n    change_time,\n    CASE\n      WHEN changed_field_key = 'lost_reason'\n        THEN new_value\n    END AS lost_reason\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"\n  WHERE changed_field_key IN ('stage_id', 'lost_reason')\n\n  UNION ALL\n\n  SELECT *\n  FROM activities\n)\n\nSELECT *\nFROM unioned", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"interm_deals_stages_enriched\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.676651Z", "completed_at": "2026-02-11T19:12:54.679903Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.680373Z", "completed_at": "2026-02-11T19:12:54.735566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.060411930084228516, "adapter_response": {"_message": "SELECT 2500", "code": "SELECT", "rows_affected": 2500}, "message": "SELECT 2500", "failures": null, "unique_id": "model.enpal_assessment_project.interm_deals_times_users", "compiled": true, "compiled_code": "WITH min_add_times AS (\n  SELECT\n    deal_id,\n    new_value,\n    changed_field_key,\n    change_time,\n    min(CASE WHEN changed_field_key = 'add_time' THEN new_value END)\n      OVER (PARTITION BY deal_id)\n      AS min_add_time,\n    count(*) OVER (PARTITION BY deal_id) AS cnt\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_deal_changes\"\n  WHERE\n    changed_field_key IN ('add_time', 'user_id')\n)\n\nSELECT\n  deal_id,\n  new_value::integer AS user_id,\n  min_add_time::timestamp AS deal_add_time,\n  CASE WHEN changed_field_key = 'user_id' THEN change_time END AS change_time\nFROM min_add_times\nWHERE changed_field_key = 'user_id'\n-- to include deals that don't have user_id changes but only have one line with add_time\nOR cnt = 1", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"interm_deals_times_users\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.740087Z", "completed_at": "2026-02-11T19:12:54.743229Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.743759Z", "completed_at": "2026-02-11T19:12:54.789750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051145315170288086, "adapter_response": {"_message": "SELECT 12", "code": "SELECT", "rows_affected": 12}, "message": "SELECT 12", "failures": null, "unique_id": "model.enpal_assessment_project.interm_dim_stages", "compiled": true, "compiled_code": "SELECT\n  stage_id,\n  stage_name\nFROM \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_stages\"\n\nUNION ALL\n\nSELECT\n  2.1 AS stage_id,\n  'Sales Call 1' AS stage_name\n\nUNION ALL\n\nSELECT\n  3.1 AS stage_id,\n  'Sales Call 2' AS stage_name\n\nUNION ALL\n\nSELECT\n  0 AS stage_id,\n  'lost' AS stage_name", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.794276Z", "completed_at": "2026-02-11T19:12:54.798740Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.799205Z", "completed_at": "2026-02-11T19:12:54.821127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02934575080871582, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_stages_enriched_change_time.65639283aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_stages_enriched\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.825818Z", "completed_at": "2026-02-11T19:12:54.830531Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.831011Z", "completed_at": "2026-02-11T19:12:54.852205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02900385856628418, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_stages_enriched_deal_id.66067f0e87", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_stages_enriched\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.857087Z", "completed_at": "2026-02-11T19:12:54.861694Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.862153Z", "completed_at": "2026-02-11T19:12:54.883905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029387950897216797, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_stages_enriched_stage.fd4e94d136", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_stages_enriched\"\nwhere stage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.888864Z", "completed_at": "2026-02-11T19:12:54.893597Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.894063Z", "completed_at": "2026-02-11T19:12:54.917490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031089067459106445, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_times_users_change_time.5d4370ef45", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_times_users\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.922384Z", "completed_at": "2026-02-11T19:12:54.926921Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.927372Z", "completed_at": "2026-02-11T19:12:54.948205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028254032135009766, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_times_users_deal_add_time.f44ee960cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_add_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_times_users\"\nwhere deal_add_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.952949Z", "completed_at": "2026-02-11T19:12:54.957708Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.958166Z", "completed_at": "2026-02-11T19:12:54.979208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028800010681152344, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_deals_times_users_deal_id.13ca085169", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_times_users\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:54.983860Z", "completed_at": "2026-02-11T19:12:54.988588Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:54.989053Z", "completed_at": "2026-02-11T19:12:55.009527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02805304527282715, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_dim_stages_stage_id.2cac627bde", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.014477Z", "completed_at": "2026-02-11T19:12:55.019272Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.019734Z", "completed_at": "2026-02-11T19:12:55.040312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028316259384155273, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_interm_dim_stages_stage_name.4c50729db1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"\nwhere stage_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.044954Z", "completed_at": "2026-02-11T19:12:55.049774Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.050235Z", "completed_at": "2026-02-11T19:12:55.070509Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028058767318725586, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_interm_dim_stages_stage_id.a90c624bad", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"\nwhere stage_id is not null\ngroup by stage_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.075301Z", "completed_at": "2026-02-11T19:12:55.082360Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.082838Z", "completed_at": "2026-02-11T19:12:55.103655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030910968780517578, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_interm_dim_stages_stage_name.2307c3f9e0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    stage_name as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"\nwhere stage_name is not null\ngroup by stage_name\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.108689Z", "completed_at": "2026-02-11T19:12:55.112804Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.113268Z", "completed_at": "2026-02-11T19:12:55.224134Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11694788932800293, "adapter_response": {"_message": "SELECT 10908", "code": "SELECT", "rows_affected": 10908}, "message": "SELECT 10908", "failures": null, "unique_id": "model.enpal_assessment_project.marts_deals_stages", "compiled": true, "compiled_code": "\n\n\nWITH stages_enriched AS (\n  SELECT\n    deal_id,\n    stage AS stage_id,\n    change_time,\n    lost_reason,\n    lead(stage) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_stage_id,\n    lead(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS next_change_time,\n    (lead(change_time) OVER (PARTITION BY deal_id ORDER BY change_time))::date\n    - change_time::date AS days_to_next_stage,\n    row_number() OVER (PARTITION BY deal_id ORDER BY change_time) AS stage_order,\n    row_number() OVER (PARTITION BY deal_id ORDER BY change_time DESC) AS stage_order_desc,\n    first_value(change_time) OVER (PARTITION BY deal_id ORDER BY change_time) AS initial_stage_time,\n    last_value(change_time)\n      OVER (\n        PARTITION BY deal_id\n        ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n      )\n      AS final_stage_time,\n    last_value(stage)\n      OVER (\n        PARTITION BY deal_id\n        ORDER BY change_time ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n      )\n      AS final_stage_id,\n    min(stage) OVER (PARTITION BY deal_id) AS min_stage_id\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_stages_enriched\"\n)\n\nSELECT\n  t.*,\n  coalesce(t.min_stage_id = 0, FALSE) AS is_ever_lost\nFROM stages_enriched AS t", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.228779Z", "completed_at": "2026-02-11T19:12:55.233737Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.234200Z", "completed_at": "2026-02-11T19:12:55.256179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030098915100097656, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_marts_deals_stages_change_time.cc0a9ab2f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect change_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"\nwhere change_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.261357Z", "completed_at": "2026-02-11T19:12:55.266075Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.266576Z", "completed_at": "2026-02-11T19:12:55.289566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03092503547668457, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_marts_deals_stages_deal_id.af8a02ecd4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.294420Z", "completed_at": "2026-02-11T19:12:55.299174Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.299660Z", "completed_at": "2026-02-11T19:12:55.320308Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028335094451904297, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_marts_deals_stages_stage_id.e16067ce98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"\nwhere stage_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.325675Z", "completed_at": "2026-02-11T19:12:55.329737Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.330190Z", "completed_at": "2026-02-11T19:12:55.397098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07295584678649902, "adapter_response": {"_message": "SELECT 1995", "code": "SELECT", "rows_affected": 1995}, "message": "SELECT 1995", "failures": null, "unique_id": "model.enpal_assessment_project.marts_deals", "compiled": true, "compiled_code": "\n\n\nWITH stages_aggregated AS (\n  SELECT\n    deal_id,\n    min(initial_stage_time) AS initial_stage_time,\n    min(CASE WHEN stage_order_desc = 2 THEN change_time END) AS pre_final_stage_time,\n    min(CASE WHEN stage_order_desc = 2 THEN stage_id END) AS pre_final_stage_id,\n    min(final_stage_time) AS final_stage_time,\n    min(CASE WHEN stage_order_desc = 1 THEN stage_id END) AS final_stage_id,\n    coalesce(min(CASE WHEN stage_order_desc = 1 THEN stage_id END) = 0, FALSE) AS is_lost,\n    CASE\n      WHEN min(CASE WHEN stage_order_desc = 1 THEN stage_id END) = 0\n        THEN min(CASE WHEN stage_order_desc = 1 THEN lost_reason END)\n    END AS lost_reason,\n    bool_or(is_ever_lost) AS is_ever_lost,\n    array_agg(stage_id ORDER BY stage_order) AS stages_sequence\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"\n  GROUP BY deal_id\n)\n\nSELECT\n  times_users.deal_id,\n  times_users.deal_add_time,\n  times_users.last_user_id,\n  times_users.last_user_change_time,\n  stages.initial_stage_time,\n  stages.pre_final_stage_id,\n  stages.pre_final_stage_time,\n  stages.final_stage_time,\n  stages.final_stage_id,\n  stages.is_lost,\n  stages.lost_reason,\n  stages.is_ever_lost,\n  stages.stages_sequence,\n  stages.final_stage_time::date - times_users.deal_add_time::date AS days_to_final_stage,\n  current_date - stages.final_stage_time::date AS days_since_final_stage\nFROM\n  (\n  SELECT DISTINCT ON (deal_id)\n    deal_id,\n    deal_add_time,\n    user_id AS last_user_id,\n    change_time AS last_user_change_time\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"interm_deals_times_users\"\n  ORDER BY deal_id ASC, change_time DESC\n  )\n  AS times_users\nLEFT JOIN stages_aggregated AS stages ON times_users.deal_id = stages.deal_id", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"marts_deals\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.401201Z", "completed_at": "2026-02-11T19:12:55.404839Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.405277Z", "completed_at": "2026-02-11T19:12:55.476547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07672905921936035, "adapter_response": {"_message": "SELECT 286", "code": "SELECT", "rows_affected": 286}, "message": "SELECT 286", "failures": null, "unique_id": "model.enpal_assessment_project.metrics_monthly_kpis", "compiled": true, "compiled_code": "\n\nWITH months_stages AS (\n  SELECT DISTINCT\n    start_month,\n    stage_id,\n    stage_name\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"stg_dim_dates\"\n  CROSS JOIN \"postgres\".\"public_pipedrive_analytics\".\"interm_dim_stages\"\n  WHERE start_date >= '2024-01-01' --hardcoded to match the start date\n),\n\ndeals_count AS (\n  SELECT\n    stage_id,\n    date_trunc('month', initial_stage_time) AS initial_stage_month,\n    count(DISTINCT deal_id) AS deals_count\n  FROM \"postgres\".\"public_pipedrive_analytics\".\"marts_deals_stages\"\n  GROUP BY 1, 2\n)\n\nSELECT\n  m_s.start_month AS month,\n  m_s.stage_name AS kpi_name,\n  m_s.stage_id AS funnel_step,\n  coalesce(deals_count.deals_count, 0) AS deals_count\nFROM months_stages AS m_s\nLEFT JOIN deals_count\n  ON m_s.start_month = deals_count.initial_stage_month AND m_s.stage_id = deals_count.stage_id\nWHERE m_s.stage_name <> 'lost' --exclude lost deals as they are not part of the funnel", "relation_name": "\"postgres\".\"public_pipedrive_analytics\".\"metrics_monthly_kpis\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.481033Z", "completed_at": "2026-02-11T19:12:55.485766Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.486247Z", "completed_at": "2026-02-11T19:12:55.507406Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028732776641845703, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_marts_deals_deal_add_time.39668a9d15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_add_time\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals\"\nwhere deal_add_time is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.512164Z", "completed_at": "2026-02-11T19:12:55.516861Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.517365Z", "completed_at": "2026-02-11T19:12:55.538570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02889275550842285, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_marts_deals_deal_id.f6b841b3e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deal_id\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals\"\nwhere deal_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.543400Z", "completed_at": "2026-02-11T19:12:55.548046Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.548505Z", "completed_at": "2026-02-11T19:12:55.570530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02956700325012207, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.unique_marts_deals_deal_id.9665c4efb6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    deal_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_pipedrive_analytics\".\"marts_deals\"\nwhere deal_id is not null\ngroup by deal_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.575075Z", "completed_at": "2026-02-11T19:12:55.579764Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.580245Z", "completed_at": "2026-02-11T19:12:55.603809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03173494338989258, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_metrics_monthly_kpis_deals_count.512c0552d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect deals_count\nfrom \"postgres\".\"public_pipedrive_analytics\".\"metrics_monthly_kpis\"\nwhere deals_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.609130Z", "completed_at": "2026-02-11T19:12:55.613942Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.614413Z", "completed_at": "2026-02-11T19:12:55.634727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028130054473876953, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_metrics_monthly_kpis_funnel_step.44eca1a063", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect funnel_step\nfrom \"postgres\".\"public_pipedrive_analytics\".\"metrics_monthly_kpis\"\nwhere funnel_step is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.639647Z", "completed_at": "2026-02-11T19:12:55.644335Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.644981Z", "completed_at": "2026-02-11T19:12:55.666147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028908252716064453, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_metrics_monthly_kpis_kpi_name.aa98a67534", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect kpi_name\nfrom \"postgres\".\"public_pipedrive_analytics\".\"metrics_monthly_kpis\"\nwhere kpi_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-02-11T19:12:55.671102Z", "completed_at": "2026-02-11T19:12:55.675685Z"}, {"name": "execute", "started_at": "2026-02-11T19:12:55.676139Z", "completed_at": "2026-02-11T19:12:55.697073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02874016761779785, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.enpal_assessment_project.not_null_metrics_monthly_kpis_month.7ea27d1e8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect month\nfrom \"postgres\".\"public_pipedrive_analytics\".\"metrics_monthly_kpis\"\nwhere month is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.5911290645599365, "args": {"log_format": "default", "project_dir": "/Users/kseniia/projects/homeworks/enpal/dbt_enpal_assessment", "require_nested_cumulative_type_params": false, "strict_mode": false, "send_anonymous_usage_stats": true, "static_parser": true, "log_level": "info", "defer": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_explicit_package_overrides_for_builtin_materializations": true, "show": false, "version_check": true, "full_refresh": true, "log_format_file": "debug", "exclude": [], "partial_parse": true, "introspect": true, "exclude_resource_types": [], "populate_cache": true, "export_saved_queries": false, "partial_parse_file_diff": true, "resource_types": [], "require_yaml_configuration_for_mf_time_spines": false, "require_unique_project_resource_names": false, "require_all_warnings_handled_by_warn_error": false, "include_saved_query": false, "cache_selected_only": false, "empty": false, "state_modified_compare_vars": false, "invocation_command": "dbt build --full-refresh", "profiles_dir": "/Users/kseniia/projects/homeworks/enpal/dbt_enpal_assessment", "log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "use_colors_file": true, "which": "build", "indirect_selection": "eager", "require_ref_searches_node_package_before_root": false, "quiet": false, "vars": {}, "upload_to_artifacts_ingest_api": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_fast_test_edges": false, "log_path": "/Users/kseniia/projects/homeworks/enpal/dbt_enpal_assessment/logs", "favor_state": false, "require_resource_names_without_spaces": true, "print": true, "macro_debugging": false, "select": [], "write_json": true, "show_resource_report": false, "require_generic_test_arguments_property": true, "show_all_deprecations": false, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "use_colors": true, "validate_macro_args": false, "printer_width": 80, "source_freshness_run_project_hooks": true}}